<!DOCTYPE html>
<html>
<head>
  <title>Context Engine Dashboard</title>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <style>
    body { font-family: system-ui; padding: 20px; background: #f5f5f5; }
    .card { background: white; border-radius: 8px; padding: 20px; margin: 10px 0; }
    .stat { display: inline-block; margin: 0 20px; }
    .stat-value { font-size: 2em; font-weight: bold; color: #2563eb; }
    .stat-label { color: #666; }
    input { width: 300px; padding: 8px; }
    button { padding: 8px 16px; margin-left: 10px; }
    .result-item { margin: 10px 0; padding: 10px; background: #f9f9f9; border-radius: 4px; }
    pre { white-space: pre-wrap; }
  </style>
</head>
<body>
  <div id="app">
    <h1>íº€ Context Engine Dashboard</h1>
    
    <div class="card">
      <h2>System Status</h2>
      <div class="stat">
        <div class="stat-value">{{ stats.documents }}</div>
        <div class="stat-label">Documents</div>
      </div>
      <div class="stat">
        <div class="stat-value">{{ stats.cacheSize }}</div>
        <div class="stat-label">Cache Size</div>
      </div>
    </div>
    
    <div class="card">
      <h2>Test Query</h2>
      <input v-model="testQuery" placeholder="Enter a query...">
      <button @click="runQuery">Search</button>
      
      <div v-if="queryResult" style="margin-top: 20px;">
        <h3>Results ({{ queryResult.responseTime }}ms)</h3>
        <div v-for="ctx in queryResult.contexts" :key="ctx.file" class="result-item">
          <strong>{{ ctx.file }}</strong> ({{ (ctx.relevance * 100).toFixed(0) }}%)
          <pre>{{ ctx.content.substring(0, 200) }}...</pre>
        </div>
        <div style="color: green;">âœ… Saved {{ queryResult.tokensSaved }}% tokens</div>
      </div>
    </div>
  </div>
  
  <script>
    const { createApp } = Vue;
    
    createApp({
      data() {
        return {
          stats: { documents: 0, cacheSize: 0 },
          testQuery: '',
          queryResult: null
        }
      },
      async mounted() {
        const res = await fetch('http://localhost:3456/health');
        this.stats = await res.json();
      },
      methods: {
        async runQuery() {
          const res = await fetch('http://localhost:3456/api/context', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ query: this.testQuery, limit: 3 })
          });
          this.queryResult = await res.json();
        }
      }
    }).mount('#app');
  </script>
</body>
</html>
